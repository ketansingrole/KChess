<html>
<head>

  <!--  Including jQuery, another tool chessboardjs uses:-->
  <script src="jquery/jquery-3.4.1.min.js"></script>
<!--  Including the chessboardjs files:-->
    <script src="./js/chessboard-1.0.0.min.js"></script>
    <script src="../chess.js-master/chess.js"></script>
    <link rel="stylesheet" href="css/chessboard-1.0.0.min.css">


  
  </head>
<body>
  <div class="container">
  <div id="board1" style="width: 50%"></div>
  </div>
  </body>

  
  
  
<script>
//   if(window.speechSynthesis.getVoices().length == 0) {
// 	window.speechSynthesis.addEventListener('voiceschanged', function() {
// 		textToSpeech();
// 	});
// }
// else {
// 	// languages list available, no need to wait
// 	textToSpeech()
// }

function textToSpeech(text_position) {
	// get all voices that browser offers
	var available_voices = window.speechSynthesis.getVoices();

	// this will hold an english voice
	var english_voice = '';

	// find voice by language locale "en-US"
	// if not then select the first voice
	for(var i=0; i<available_voices.length; i++) {
		if(available_voices[i].lang === 'en-US') {
			english_voice = available_voices[i];
			break;
		}
	}
	if(english_voice === '')
		english_voice = available_voices[0];

	// new SpeechSynthesisUtterance object
	var utter = new SpeechSynthesisUtterance();
	utter.rate = 1;
	utter.pitch = 0.5;
	utter.text = text_position;
	utter.voice = english_voice;

	// event after text has been spoken
	// utter.onend = function() {
	// 	alert('Speech has finished');
	// }

	// speak
	window.speechSynthesis.speak(utter);
}

  var chess = new Chess();
  function onDrop (source, target, piece, newPos, oldPos, orientation) {
  console.log('Source: ' + source)
  console.log('Target: ' + target)
  console.log('Piece: ' + piece)
  console.log('New position: ' + Chessboard.objToFen(newPos))
  console.log('Old position: ' + Chessboard.objToFen(oldPos))
  console.log('Orientation: ' + orientation)
  console.log('~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~')
  if(chess.move({ from: source, to: target, promotion: 'q'}) == null){
    
    return 'snapback'
  }
  // textToSpeech(piece+" "+source+" "+target)

  console.log("displaying chess values")
  console.log(chess.pgn());
  // temp = chess.history();
  // textToSpeech(temp[temp.length-1]);
}

function onSnapEnd () {
  board.position(chess.fen())
}
// --- Begin Example JS --------------------------------------------------------
var config = {
  draggable: true,
  dropOffBoard: 'snapback', // this is the default
  onDrop: onDrop,
  showNotation: true,
  onSnapEnd: onSnapEnd,
  pieceTheme: 'img/chesspieces/cburnett/{piece}.svg',
  position: 'start'
}
var board = Chessboard('board1', config)
// var Chess = require('./chess').Chess;


// --- End Example JS ----------------------------------------------------------

</script>

</html>